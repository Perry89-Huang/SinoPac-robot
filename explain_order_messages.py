"""
è¨‚å–®ç‹€æ…‹è¨Šæ¯è§£æå™¨
å°‡æŠ€è¡“æ€§çš„è¨‚å–®å›å ±è½‰æ›æˆæ˜“æ‡‚çš„æ ¼å¼
"""
from datetime import datetime
from tabulate import tabulate

def parse_order_message(message: str):
    """è§£æè¨‚å–®è¨Šæ¯"""
    # ç¯„ä¾‹è¨Šæ¯è§£æ
    results = []
    
    # æ¨¡æ“¬è§£æï¼ˆå¯¦éš›ä½¿ç”¨æ™‚æœƒå¾çœŸå¯¦è³‡æ–™è§£æï¼‰
    orders = [
        {
            'type': 'ä¸‹å–®',
            'time': '13:58:42',
            'code': 'CSFB6',
            'name': 'è¯æ–°æœŸè²¨02',
            'action': 'è³£å‡º',
            'price': 33.9,
            'quantity': 5,
            'status': 'å§”è¨—æˆåŠŸ'
        },
        {
            'type': 'ä¸‹å–®',
            'time': '13:58:42',
            'code': 'CSFA6',
            'name': 'è¯æ–°æœŸè²¨01',
            'action': 'è²·é€²',
            'price': 33.85,
            'quantity': 5,
            'status': 'å§”è¨—æˆåŠŸ'
        },
        {
            'type': 'æˆäº¤',
            'time': '13:59:50',
            'code': 'CSFB6',
            'name': 'è¯æ–°æœŸè²¨02',
            'action': 'è³£å‡º',
            'price': 33.9,
            'quantity': 1,
            'status': 'âœ… éƒ¨åˆ†æˆäº¤'
        },
        {
            'type': 'æˆäº¤',
            'time': '13:59:51',
            'code': 'CSFB6',
            'name': 'è¯æ–°æœŸè²¨02',
            'action': 'è³£å‡º',
            'price': 33.9,
            'quantity': 4,
            'status': 'âœ… å…¨éƒ¨æˆäº¤'
        },
        {
            'type': 'æˆäº¤',
            'time': '13:59:52',
            'code': 'CSFA6',
            'name': 'è¯æ–°æœŸè²¨01',
            'action': 'è²·é€²',
            'price': 33.85,
            'quantity': 1,
            'status': 'âœ… éƒ¨åˆ†æˆäº¤'
        },
        {
            'type': 'æˆäº¤',
            'time': '13:59:52',
            'code': 'CSFA6',
            'name': 'è¯æ–°æœŸè²¨01',
            'action': 'è²·é€²',
            'price': 33.85,
            'quantity': 1,
            'status': 'âœ… éƒ¨åˆ†æˆäº¤'
        },
        {
            'type': 'æˆäº¤',
            'time': '13:59:52',
            'code': 'CSFA6',
            'name': 'è¯æ–°æœŸè²¨01',
            'action': 'è²·é€²',
            'price': 33.85,
            'quantity': 1,
            'status': 'âœ… éƒ¨åˆ†æˆäº¤'
        },
        {
            'type': 'æˆäº¤',
            'time': '13:59:58',
            'code': 'CSFA6',
            'name': 'è¯æ–°æœŸè²¨01',
            'action': 'è²·é€²',
            'price': 33.85,
            'quantity': 2,
            'status': 'âœ… å…¨éƒ¨æˆäº¤'
        }
    ]
    
    return orders


def display_order_summary():
    """é¡¯ç¤ºæ˜“æ‡‚çš„è¨‚å–®æ‘˜è¦"""
    
    print("\n" + "="*100)
    print("ğŸ“‹ è¨‚å–®åŸ·è¡Œæ‘˜è¦")
    print("="*100)
    
    # ä¸‹å–®éšæ®µ
    print("\nğŸ”µ ç¬¬ä¸€éšæ®µï¼šå§”è¨—ä¸‹å–®")
    print("-"*100)
    order_data = [
        ['1', '13:58:42', 'CSFB6 è¯æ–°æœŸè²¨02', 'è³£å‡º', 5, '33.90', 'âœ“ å§”è¨—æˆåŠŸ'],
        ['2', '13:58:42', 'CSFA6 è¯æ–°æœŸè²¨01', 'è²·é€²', 5, '33.85', 'âœ“ å§”è¨—æˆåŠŸ']
    ]
    headers = ['#', 'æ™‚é–“', 'å•†å“', 'æ–¹å‘', 'å£æ•¸', 'åƒ¹æ ¼', 'ç‹€æ…‹']
    print(tabulate(order_data, headers=headers, tablefmt='simple'))
    print("ğŸ’¡ èªªæ˜ï¼šå·²æˆåŠŸé€å‡º 2 ç­†å§”è¨—å–®ï¼Œç­‰å¾…å¸‚å ´æ’®åˆæˆäº¤")
    
    # æˆäº¤éšæ®µ
    print("\n" + "="*100)
    print("âœ… ç¬¬äºŒéšæ®µï¼šæˆäº¤å›å ±")
    print("-"*100)
    
    deal_data = [
        ['1', '13:59:50', 'CSFB6 è¯æ–°æœŸè²¨02', 'è³£å‡º', 1, '33.90', '1/5 å£æˆäº¤'],
        ['2', '13:59:51', 'CSFB6 è¯æ–°æœŸè²¨02', 'è³£å‡º', 4, '33.90', '5/5 å£æˆäº¤ âœ…'],
        ['3', '13:59:52', 'CSFA6 è¯æ–°æœŸè²¨01', 'è²·é€²', 1, '33.85', '1/5 å£æˆäº¤'],
        ['4', '13:59:52', 'CSFA6 è¯æ–°æœŸè²¨01', 'è²·é€²', 1, '33.85', '2/5 å£æˆäº¤'],
        ['5', '13:59:52', 'CSFA6 è¯æ–°æœŸè²¨01', 'è²·é€²', 1, '33.85', '3/5 å£æˆäº¤'],
        ['6', '13:59:58', 'CSFA6 è¯æ–°æœŸè²¨01', 'è²·é€²', 2, '33.85', '5/5 å£æˆäº¤ âœ…']
    ]
    headers = ['#', 'æ™‚é–“', 'å•†å“', 'æ–¹å‘', 'å£æ•¸', 'åƒ¹æ ¼', 'é€²åº¦']
    print(tabulate(deal_data, headers=headers, tablefmt='simple'))
    print("ğŸ’¡ èªªæ˜ï¼šå§”è¨—å–®é™¸çºŒæˆäº¤ï¼Œå¾ä¸‹å–®åˆ°å®Œå…¨æˆäº¤ç´„ 16 ç§’")
    
    # æœ€çµ‚çµæœ
    print("\n" + "="*100)
    print("ğŸ¯ åŸ·è¡Œçµæœçµ±è¨ˆ")
    print("="*100)
    
    summary_data = [
        ['CSFB6 è¯æ–°æœŸè²¨02', 'è³£å‡º', 5, 5, '100%', '33.90', 'âœ… å®Œå…¨æˆäº¤'],
        ['CSFA6 è¯æ–°æœŸè²¨01', 'è²·é€²', 5, 5, '100%', '33.85', 'âœ… å®Œå…¨æˆäº¤']
    ]
    headers = ['å•†å“', 'æ–¹å‘', 'å§”è¨—', 'æˆäº¤', 'æˆäº¤ç‡', 'å‡åƒ¹', 'ç‹€æ…‹']
    print(tabulate(summary_data, headers=headers, tablefmt='grid'))
    
    print("\nğŸ“Š äº¤æ˜“æç›Šï¼š")
    print(f"   â€¢ è³£å‡º CSFB6ï¼š5 å£ Ã— 33.90 = 169.50 å…ƒ")
    print(f"   â€¢ è²·é€² CSFA6ï¼š5 å£ Ã— 33.85 = 169.25 å…ƒ")
    print(f"   â€¢ æ·¨æç›Šï¼š+0.25 å…ƒï¼ˆæœªè¨ˆæ‰‹çºŒè²»ï¼‰")
    
    print("\nâ±ï¸  æ™‚é–“è»¸ï¼š")
    print("   13:58:42 â”€â”€> ä¸‹å–®ï¼ˆ2ç­†å§”è¨—ï¼‰")
    print("   13:59:50 â”€â”€> é–‹å§‹æˆäº¤")
    print("   13:59:58 â”€â”€> å…¨éƒ¨æˆäº¤ âœ…")
    print("   ç¸½è€—æ™‚ï¼šç´„ 16 ç§’")
    
    print("\nğŸ’¡ é€™æ˜¯ä»€éº¼æ„æ€ï¼Ÿ")
    print("   é€™äº›è¨Šæ¯é¡¯ç¤ºæ‚¨çš„å¹³å€‰å–®å·²ç¶“å®Œå…¨æˆäº¤ï¼š")
    print("   1ï¸âƒ£  è³£å‡º 5 å£è¯æ–°æœŸè²¨02ï¼ˆCSFB6ï¼‰ä¾†å¹³å€‰ä¹‹å‰è²·é€²çš„éƒ¨ä½")
    print("   2ï¸âƒ£  è²·é€² 5 å£è¯æ–°æœŸè²¨01ï¼ˆCSFA6ï¼‰ä¾†å¹³å€‰ä¹‹å‰è³£å‡ºçš„éƒ¨ä½")
    print("   3ï¸âƒ£  å…©ç­†è¨‚å–®éƒ½ 100% æˆäº¤ï¼Œè¯æ–°çš„éƒ¨ä½å·²ç¶“å¹³å€‰å®Œç•¢ï¼")
    
    print("="*100 + "\n")


def display_simple_explanation():
    """è¶…ç°¡å–®èªªæ˜ç‰ˆæœ¬"""
    print("\n" + "="*100)
    print("ğŸ¯ ç™½è©±æ–‡è§£èªª")
    print("="*100)
    
    print("\nğŸ“Œ ç™¼ç”Ÿäº†ä»€éº¼äº‹ï¼Ÿ")
    print("-"*100)
    print("ä½ å‰›æ‰å¹³å€‰äº†è¯æ–°æœŸè²¨çš„æŒå€‰ï¼š")
    print()
    print("  ğŸ”µ ä¸‹å–®éšæ®µï¼ˆ13:58:42ï¼‰")
    print("     â†’ é€å‡º 2 ç­†å¹³å€‰å§”è¨—å–®")
    print("     â†’ ç³»çµ±å›æ‡‰ï¼šå§”è¨—æˆåŠŸï¼Œç­‰å¾…æˆäº¤")
    print()
    print("  âœ… æˆäº¤éšæ®µï¼ˆ13:59:50 ~ 13:59:58ï¼Œå…± 16 ç§’ï¼‰")
    print("     â†’ è³£å‡º 5 å£è¯æ–°æœŸè²¨02ï¼š33.90 å…ƒæˆäº¤ âœ…")
    print("     â†’ è²·é€² 5 å£è¯æ–°æœŸè²¨01ï¼š33.85 å…ƒæˆäº¤ âœ…")
    print()
    print("  ğŸ‰ çµæœ")
    print("     â†’ è¯æ–°æœŸè²¨æŒå€‰å·²å®Œå…¨å¹³å€‰")
    print("     â†’ å…©ç­†è¨‚å–® 100% æˆäº¤")
    print("     â†’ ä¸å†æŒæœ‰è¯æ–°æœŸè²¨")
    
    print("\nğŸ’­ ç‚ºä»€éº¼æœ‰é€™éº¼å¤šè¨Šæ¯ï¼Ÿ")
    print("-"*100)
    print("  â€¢ FuturesOrder = ä¸‹å–®é€šçŸ¥ï¼ˆå‘Šè¨´ä½ å–®å­å·²é€å‡ºï¼‰")
    print("  â€¢ FuturesDeal  = æˆäº¤é€šçŸ¥ï¼ˆå‘Šè¨´ä½ å–®å­æˆäº¤äº†å¤šå°‘ï¼‰")
    print("  â€¢ æˆäº¤å¯èƒ½åˆ†æ‰¹ï¼š5 å£å¯èƒ½åˆ†æˆ 1+4 æˆ– 1+1+1+2 å£æ…¢æ…¢æˆäº¤")
    print("  â€¢ é€™æ˜¯æ­£å¸¸çš„ï¼å¸‚å ´æœƒæ…¢æ…¢æ’®åˆä½ çš„è¨‚å–®")
    
    print("\nâœ¨ ç¸½çµ")
    print("-"*100)
    print("  âœ… è¯æ–°æœŸè²¨å·²å®Œå…¨å¹³å€‰")
    print("  âœ… æ‰€æœ‰å§”è¨—å–®éƒ½æˆäº¤äº†")
    print("  âœ… é€™æ˜¯æˆåŠŸçš„äº¤æ˜“ï¼")
    
    print("="*100 + "\n")


def main():
    """ä¸»ç¨‹å¼"""
    print("\n" + "="*100)
    print("ğŸ“Š è¨‚å–®ç‹€æ…‹è¨Šæ¯è§£æå·¥å…·")
    print("="*100)
    
    print("\nè«‹é¸æ“‡é¡¯ç¤ºæ–¹å¼ï¼š")
    print("1. è©³ç´°ç‰ˆï¼ˆå®Œæ•´äº¤æ˜“æµç¨‹ï¼‰")
    print("2. ç°¡å–®ç‰ˆï¼ˆç™½è©±æ–‡èªªæ˜ï¼‰")
    print("3. å…©å€‹éƒ½çœ‹")
    
    choice = input("\nè«‹é¸æ“‡ (1/2/3): ").strip()
    
    if choice == '1':
        display_order_summary()
    elif choice == '2':
        display_simple_explanation()
    elif choice == '3':
        display_order_summary()
        display_simple_explanation()
    else:
        print("é è¨­é¡¯ç¤ºç°¡å–®ç‰ˆï¼š")
        display_simple_explanation()


if __name__ == "__main__":
    # ç›´æ¥é¡¯ç¤ºå…©ç¨®ç‰ˆæœ¬
    display_simple_explanation()
    input("\næŒ‰ Enter æŸ¥çœ‹è©³ç´°ç‰ˆ...")
    display_order_summary()
